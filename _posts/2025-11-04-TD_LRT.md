---
layout: post
title: Time-Dependent Linear Response Theory
date: 2025-11-04
categories: Post
description: A simple derivation of time-dependent linear response theory.
tags: DFT, Math
---

<!-- {% include admonition.html type="info" title="Note" body=" -->
<!-- Note that here, unlike in most text books, I have opted to not use the interacting picture.  -->
<!-- " %} -->
{% include admonition.html type="quote" title="References:" body="
- Ref: https://ocw.mit.edu/courses/8-06-quantum-physics-iii-spring-2018/89ef6d5958ee59bae9a91345c3d8c8e4_MIT8_06S18ch4.pdf <br>
- Ref: https://www.tcm.phy.cam.ac.uk/~bds10/aqp/handout_dep.pdf
" %}


We are considering a Hamiltonian split as:

$$
H(t) = H_0 + \lambda V(t) 
$$

where $H_0$ is the unperturbed time-independent Hamiltonian (which we know how to solve), and $\lambda V(t)$ is the time-dependent perturbation where $\lambda$ is a parameter that controls how small the perturbation is.

The full Schr√∂dinger equation can be written as:

$$
i\hbar \frac{\partial}{\partial t} \ket{\psi(t)} = H(t)\ket{\psi(t)} = [H_0 + \lambda V(t)]\ket{\psi(t)}  \tag{1}
$$



The eigenstates $\ket{n}$ and eigenvalues $E_n$ of the stationary $H_0$ satisfy

$$
H_0\ket{n} = E_n \ket{n}
$$

Without perturbation, the stationary time-evolution of eigenstate $\ket{n}$ is

$$
\ket{n(t)} = e^{-iE_nt/\hbar} \ket{n}
$$


We expand the full solution $\ket{\psi(t)}$ in terms of the unperturbed eigenstates $\ket{m(t)}$:

$$
\ket{\psi(t)} = \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m} \tag{2}
$$

assuming the perturbation $\lambda V(t)$ is small, the expansion coefficients $c_m(t)$ should vary very slow.

Now plug Eq. 2 into Eq. 1, we get

$$
\begin{aligned}
i\hbar \frac{\partial}{\partial t} \ket{\psi(t)} &= [H_0 + \lambda  V(t)]\ket{\psi(t)} \\
i\hbar \frac{\partial}{\partial t} \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m} &= [H_0 + \lambda  V(t)]  \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
i\hbar \sum_m (\dot{c}_m(t) e^{-iE_mt/\hbar} \ket{m} - iE_m/\hbar c_m(t) e^{-iE_mt/\hbar} \ket{m}) &= [H_0 +  \lambda V(t)]  \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
i\hbar \sum_m \dot{c}_m(t) e^{-iE_mt/\hbar} \ket{m} +\sum_m  E_m c_m(t) e^{-iE_mt/\hbar} \ket{m} &= [H_0 +  \lambda V(t)]  \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
i\hbar \sum_m \dot{c}_m(t) e^{-iE_mt/\hbar} \ket{m} &= \lambda  V(t)  \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
\end{aligned}
$$

left multiply by $\bra{n}$ and use the orthonormal condition of the stationary eigenstates $\braket{n\|m}=\delta_{mn}$

$$
\begin{aligned}
i\hbar \dot{c}_n(t) e^{-iE_nt/\hbar} &= \sum_m  c_m(t) e^{-iE_mt/\hbar} \braket{n| \lambda V(t)|m}\\
\dot{c}_n(t) &=  \frac{1}{i\hbar}\sum_m  c_m(t) e^{-i(E_m-E_n)t/\hbar} \braket{n| \lambda V(t)|m}\\
\end{aligned}
$$

and we can rewrite it to 

$$
\dot{c}_n(t) =  \frac{1}{i\hbar}\sum_m  c_m(t) e^{i\omega_{nm}t}  \lambda V_{nm}(t) \tag{3}
$$

where $\omega_{nm}=\frac{E_n-E_m}{\hbar}$ and $V_{nm}(t)=\braket{n\|V(t)\|m}$.


We can expand the time-dependent coefficients $c_m(t)$ in powers of the parameter $\lambda$

$$
c_m(t) = c_m^{(0)}(t) + \lambda c_m^{(1)}(t) + \lambda^2 c_m^{(2)}(t) + \cdots \tag{4}
$$

Assuming we are starting from time $t_0$ and systems is prepared to be in state $i$, the zeroth order expansion should be stationary coefficients at $t_0$ (as $\lambda=0$, we turn off the interaction and system becomes time independent)

$$
c_m(t_0) = c_m^{(0)}(t) = \delta_{mi}
$$

which means the zeroth coefficients are constants and $\dot{c}_m^{(0)}(t) = 0$, combining with Eq. 4, the expansion of Eq.3 can be written as

$$
\begin{aligned}
% \dot{c}_n(t) &=  \frac{1}{i\hbar}\sum_m  c_m(t) e^{i\omega_{nm}t} \lambda V_{nm}(t) \\
\dot{c}_n(t)^{(0)} &+ \lambda \dot{c}_n(t)^{(1)} + \lambda^2 \dot{c}_n(t)^{(2)}  + \cdots\\
&=\frac{1}{i\hbar}\sum_m  \lambda c^{(0)}_m(t) e^{i\omega_{nm}t} V_{nm}(t) + \frac{1}{i\hbar}\sum_m \lambda^2 c^{(1)}_m(t) e^{i\omega_{nm}t} V_{nm}(t)  \cdots
\end{aligned}
$$

To first order of $\lambda$, we have

$$
\begin{aligned}
\dot{c}_n(t)^{(1)} &= \frac{1}{i\hbar}\sum_m  c^{(0)}_m(t) e^{i\omega_{nm}t} V_{nm}(t) \\
&= \frac{1}{i\hbar}\sum_m  \delta_{mi} e^{i\omega_{nm}t} V_{nm}(t)\\
&= \frac{1}{i\hbar} e^{i\omega_{ni}t} V_{ni}(t)\tag{6}
\end{aligned}
$$

Using fundamental theorem of calculus

$$
{c}_n(t)^{(1)} - {c}_n(t_0)^{(1)} = \int_{t_0}^t \delta t' \dot{c}(t')^{(1)}
$$

since the system is initialized at $c_m(t_0) =\delta_{mi}$, we have ${c}_n(t_0)^{(1)}=0$, hence

$$
{c}_n(t)^{(1)} =  \frac{1}{i\hbar}  \int_{t_0}^t \delta t' e^{i\omega_{ni}t'} V_{ni}(t')  \tag{7}
$$

Combining with the zeroth order $c_n(t)^{(0)}=\delta_{ni}$ , we see that to first order, $c_n(t) = c_n(t)^{(1)}+\delta_{ni}$. 
This is the amplitude of possibility (to the first order) of system (initialized to be in state $\ket{i}$) end up in state $\ket{n}$ ($n\neq i$) after time $t$, in other words, the first-order transition amplitude for going from state $\ket{i}$ to $\ket{n}$ ($n\neq i$) is

$$
a_{i\to n}(t) = {c}_n(t) =  \frac{1}{i\hbar}  \int_{t_0}^t \delta t' e^{i\omega_{ni}t'} V_{ni}(t') \tag{5}
$$

and the corresponding transition probability is

$$
P_{i\to n}(t) = |a_{i\to n}(t) |^2
$$


<!-- {% include admonition.html type="note" title="note" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="abstract" title="abstract" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="info" title="Info" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="tip" title="tip" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="success" title="success" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="question" title="question" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="warning" title="warning" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="failure" title="failure" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="danger" title="danger" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="bug" title="bug" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="example" title="example" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="quote" title="quote" body="This is information intended to draw attention." %} -->

