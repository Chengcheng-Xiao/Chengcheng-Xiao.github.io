---
layout: post
title: Time-Dependent Linear Response Theory
date: 2025-11-04
categories: Post
description: A simple derivation of time-dependent linear response theory.
tags: DFT, Math
---

<!-- {% include admonition.html type="info" title="Note" body=" -->
<!-- Note that here, unlike in most text books, I have opted to not use the interacting picture.  -->
<!-- " %} -->
{% include admonition.html type="quote" title="References" body="
- Ref: https://ocw.mit.edu/courses/8-06-quantum-physics-iii-spring-2018/89ef6d5958ee59bae9a91345c3d8c8e4_MIT8_06S18ch4.pdf <br>
- Ref: https://www.tcm.phy.cam.ac.uk/~bds10/aqp/handout_dep.pdf
" %}

We are considering a Hamiltonian split as:

$$
H(t) = H_0 + \lambda V(t) 
$$

where $H_0$ is the unperturbed time-independent Hamiltonian (which we know how to solve), and $\lambda V(t)$ is the time-dependent perturbation where $\lambda$ is a parameter that controls how small the perturbation is.

The full Schr√∂dinger equation can be written as:

$$
i\hbar \frac{\partial}{\partial t} \ket{\psi(t)} = H(t)\ket{\psi(t)} = [H_0 + \lambda V(t)]\ket{\psi(t)}  \tag{1}
$$

The eigenstates $\ket{n}$ and eigenvalues $E_n$ of the stationary $H_0$ satisfy

$$
H_0\ket{n} = E_n \ket{n}
$$

Without perturbation, the time-evolution of stationary eigenstate $\ket{n}$ follows energy conservation:

$$
\ket{n(t)} = e^{-iE_nt/\hbar} \ket{n}
$$

We start by expand the full solution $\ket{\psi(t)}$ in terms of the unperturbed eigenstates $\ket{m(t)}$:

$$
\ket{\psi(t)} = \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m} \tag{2}
$$

we can do this when the perturbation $\lambda V(t)$ is small **and $\ket{m}$ (approximately) span the entire Hilbert space.**
<!-- Correspondingly, due to the small $\lambda V(t)$, the expansion coefficients $c_m(t)$ should vary very slow. -->

{% include admonition.html type="note" title="$\lambda$ dependence" body="
Note that since $\ket{\psi(t)}$ is the full time dependent wavefunction which depends on $\lambda$, the expansion coefficients $c_m(t)$ (implicitly) depends on $\lambda$ as well.
" %}

Now plug Eq. 2 into Eq. 1, we get

$$
\begin{aligned}
i\hbar \frac{\partial}{\partial t} \ket{\psi(t)} &= [H_0 + \lambda  V(t)]\ket{\psi(t)} \\
i\hbar \frac{\partial}{\partial t} \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m} &= [H_0 + \lambda  V(t)]  \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
i\hbar \sum_m \left [ \dot{c}_m(t) e^{-iE_mt/\hbar} \ket{m} - iE_m/\hbar c_m(t) e^{-iE_mt/\hbar} \ket{m} \right] &= [H_0 +  \lambda V(t)]  \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
% i\hbar \sum_m \dot{c}_m(t) e^{-iE_mt/\hbar} \ket{m} +\sum_m  E_m c_m(t) e^{-iE_mt/\hbar} \ket{m} &= [H_0 +  \lambda V(t)]  \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
i\hbar \sum_m \dot{c}_m(t) e^{-iE_mt/\hbar} \ket{m} &= \lambda  V(t)  \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
\end{aligned}
$$

left multiply by $\bra{n}$ and use the orthonormal condition of the stationary eigenstates $\braket{n\|m}=\delta_{mn}$

$$
\begin{aligned}
i\hbar \dot{c}_n(t) e^{-iE_nt/\hbar} &= \sum_m  c_m(t) e^{-iE_mt/\hbar} \braket{n| \lambda V(t)|m}\\
\dot{c}_n(t) &=  \frac{1}{i\hbar}\sum_m  c_m(t) e^{-i(E_m-E_n)t/\hbar} \braket{n| \lambda V(t)|m}\\
\end{aligned}
$$

which is the equation of motion of the states under the stationary eigenstate basis. It can be re-write as

$$
\dot{c}_n(t) =  \frac{1}{i\hbar}\sum_m  c_m(t) e^{i\omega_{nm}t}  \lambda V_{nm}(t) \tag{3}
$$

where $\omega_{nm} = \frac{E_n-E_m}{\hbar}$ and $V_{nm}(t)=\braket{n\| V(t)\|m}$.

{% include admonition.html type="note" title="Maclaurin series" body="
The Maclaurin is Taylor series expanded at zero
$$
f(x)|_{x\to 0} = \sum_{n=0}^\infty \frac{f^{(n)}(a)}{n!} (x^n)
$$
" %}

Remembering that $c_m(t)$ also depends on $\lambda$ via $\ket{\psi(t)}$, we can expand the time-dependent coefficients $c_m(t)$ in powers of the parameter $\lambda$ (Maclaurin series, ignoring the $1/n!$ as it does not matter in this case)

$$
c_m(t) = c_m^{(0)}(t) + \lambda c_m^{(1)}(t) + \lambda^2 c_m^{(2)}(t) + \cdots \tag{4}
$$

If we also expand $\dot{c}_n(t)$ as a Maclaurin series of $\lambda$,

$$
\begin{aligned}
\dot{c}_n(t) &= \dot{c}_n(t)^{(0)} + \lambda \dot{c}_n(t)^{(1)} + \lambda^2 \dot{c}_n(t)^{(2)}  + \cdots \tag{5}
\end{aligned}
$$

substituting Eq. 4 into Eq.3, we see that

$$
\begin{aligned}
\dot{c}_n(t) &=\frac{1}{i\hbar}\sum_m  \lambda c^{(0)}_m(t) e^{i\omega_{nm}t} V_{nm}(t) + \frac{1}{i\hbar}\sum_m \lambda^2 c^{(1)}_m(t) e^{i\omega_{nm}t} V_{nm}(t) + \cdots \tag{5.1}
\end{aligned}
$$

Comparing Eq. 5.1 to Eq. 5, we can get the expression of $\dot{c}_n(t)$ at each order of $\lambda$ using $c_n(t)$.

Focusing on the zero-th order term of $\lambda$

$$
\dot{c}_n(t)^{(0)} = 0
$$

hence we know that 

$$
c_n(t)^{(0)}  = \mathrm{constant}
$$

{% include admonition.html type="note" title="Initial state" body="
Assuming we are starting from time $t_0$ and systems is prepared to be in state $i$ (for multi-Fermion, non-interacting system, a series of occupied initial states), i.e.,

$$
\ket{\psi(t_0)} = \sum_m c_m(t_0) e^{-iE_mt_0/\hbar} \ket{m} = c_i(t_0) e^{-iE_it_0/\hbar} \ket{i}=e^{-iE_it_0/\hbar} \ket{i},
$$

the $\lambda$ expansion of $c_m(t)$ at $t_0$ should be stationary and we have

$$
c_m(t_0) = \delta_{mi} = c_m^{(0)}(t_0) \tag{4.1}
$$

and (again because at $t_0$ no matter how we change $\lambda$, we have system prepared in $\ket{i}$), 

$$
c_m^{(1)}(t_0) = c_m^{(2)}(t_0) = \cdots =c_m^{(n)}(t_0) =0 \tag{4.2}
$$
<!-- we also realize that the zero-th order coefficients are time independent
which means the zero-th order coefficients are constants and $\dot{c}_m^{(0)}(t) = 0$.  -->
" %}

Combining with Eq. 4.1, we see

$$
c_n(t)^{(0)}  = \delta_{ni}
$$

### First order
Focusing on the first order term of $\lambda$, we have

$$
\begin{aligned}
\dot{c}_n(t)^{(1)} &= \frac{1}{i\hbar}\sum_m  c^{(0)}_m(t) e^{i\omega_{nm}t} V_{nm}(t) \\
&= \frac{1}{i\hbar}\sum_m  \delta_{mi} e^{i\omega_{nm}t} V_{nm}(t)\\
&= \frac{1}{i\hbar} e^{i\omega_{ni}t} V_{ni}(t)\tag{6}
\end{aligned}
$$

Using fundamental theorem of calculus

$$
{c}_n(t)^{(1)} - {c}_n(t_0)^{(1)} = \int_{t_0}^t \delta t' \dot{c}(t')^{(1)}
$$

Remembering Eq. 4.2, ${c}_n(t_0)^{(1)}=0$, we can write

$$
{c}_n(t)^{(1)} =  \frac{1}{i\hbar}  \int_{t_0}^t \delta t' e^{i\omega_{ni}t'} V_{ni}(t')  \tag{7}
$$

Combining with the zeroth order $c_n(t)^{(0)}=\delta_{ni}$, we see that up to first order

$$
{c}_n(t) = \delta_{ni} + {c}_n(t)^{(1)}= \delta_{ni} + \frac{1}{i\hbar}  \int_{t_0}^t \delta t' e^{i\omega_{ni}t'} V_{ni}(t')
$$ 

This coefficient represents the amplitude (to the first order) of a system initialised to be in state $\ket{i}$ that ended up in state $\ket{n}$ ($n\neq i$) after time $t$. 

In other words, the first-order transition amplitude for going from state $\ket{i}$ to $\ket{n}$ ($n\neq i$) at time $t$ is

$$
a_{i\to n}(t) = {c}_n(t) =  \frac{1}{i\hbar}  \int_{t_0}^t \delta t' e^{i\omega_{ni}t'} V_{ni}(t') \tag{8}
$$

and the corresponding transition probability is

$$
P_{i\to n}(t) = |a_{i\to n}(t) |^2
$$

### Second order
Focusing on the second order term

$$
 \dot{c}_n^{(2)}(t) = \frac{1}{i\hbar}\sum_m c^{(1)}_m(t) e^{i\omega_{nm}t} V_{nm}(t) 
$$

integrating from $t_0$ to $t$

$$
\begin{aligned}
c_n^{(2)}(t) &=  \frac{1}{i\hbar}\sum_m \int_{t_0}^t c^{(1)}_m(t) e^{i\omega_{nm}t} V_{nm}(t)\\
&= \frac{1}{i\hbar}\sum_m \int_{t_0}^{t} \delta t''
\left[ \frac{1}{i\hbar}  \int_{t_0}^{t''} \delta t' e^{i\omega_{mi}t'} V_{mi}(t') \right]
e^{i\omega_{nm}t''} V_{nm}(t'')\\
&= \frac{-1}{\hbar} \sum_m \int_{t_0}^{t} \delta t''  \int_{t_0}^{t''} \delta t' V_{nm}(t'')V_{mi}(t') e^{i\omega_{mi}t'} e^{i\omega_{nm}t''} 
\end{aligned}
$$


---

## Normalisation of $\phi(t)$
Next, let's investigate the norm of the time-dependent wavefunction
$\ket{\psi(t)}$ when it is expanded to different orders of $\lambda$.

The norm of $\psi (t)$ reads

$$
\begin{aligned}
|\psi (t)|^2 &=\left | \sum_m c_m(t) e^{-iE_mt/\hbar} \ket{m} \right |^2\\
&=\sum_{mn} \bra{n} c^*_n(t) e^{iE_n t/\hbar} c_m(t) e^{-iE_mt/\hbar} \ket{m}\\
&=\sum_{mn} c^*_n(t)c_m(t)  e^{i(E_n - E_m) t/\hbar} \delta_{nm}\\
&=\sum_{n} c^*_n(t)c_n(t)  e^{i(E_n - E_n) t/\hbar} \\
&=\sum_{n} c^*_n(t)c_n(t) \\
&= \sum_{n}  \left( \delta_{ni} + {c}_n(t)^{(1)*} \right )\left (\delta_{ni} + {c}_n(t)^{(1)}\right) \\
&= \sum_{n}  \left( |\delta_{ni}|^2 + \delta_{ni}{c}_n(t)^{(1)*} + \delta_{ni}^* {c}_n(t)^{(1)} + |{c}_n(t)^{(1)}|^2 \right ) \\
&=  1 +{c}_i(t)^{(1)*} + {c}_i(t)^{(1)} + \sum_n |{c}_n(t)^{(1)}|^2\\
\end{aligned}
$$

we notice that

$$
{c}_i(t)^{(1)} = \frac{1}{i\hbar}  \int_{t_0}^t \delta t' e^{i\omega_{ii}t'} V_{ii}(t')  = \frac{1}{i\hbar}  \int_{t_0}^t \delta t'V_{ii}(t')
$$

is either zero ($V_{ii}=0$) or pure imaginary (because $V_{ii}$ should be real as $V$ is hermitian) , hence

$$
{c}_i(t)^{(1)*} + {c}_i(t)^{(1)} =0
$$

so that

$$
|\psi (t)|^2 = 1 + \sum_n |{c}_n(t)^{(1)}|^2
$$

where we do see **an increase in the norm, and the difference being the possibility of finding the system in state $n$, i.e., $\sum_n \|{c}_n(t)^{(1)}\|^2$ !**

Now, if we expand $c$ to second order with respect to $\lambda$, the norm would go like

$$
1 + \left[ {c}_i(t)^{(2)} +  {c}_i(t)^{(2)*}  \right] + \sum_n |{c}_n(t)^{(1)}|^2 + O(\lambda^3) + O(\lambda^4)
$$

where

$$
\begin{aligned}
 {c}_i(t)^{(2)} +  {c}_i(t)^{(2)*}  &= -\frac{1}{\hbar^2} \sum_m \int_{t_0}^{t} dt' \int_{t_0}^{t'} dt'' V_{im}(t') V_{mi}(t'') e^{i\omega_{im}(t'-t'')} \\&
 + -\frac{1}{\hbar^2} \sum_m \int_{t_0}^{t} dt' \int_{t_0}^{t'} dt'' V_{mi}(t') V_{im}(t'') e^{-i\omega_{im}(t'-t'')}\\
 &= -\frac{1}{\hbar^2} \sum_m \int_{t_0}^{t} dt' \int_{t_0}^{t'} dt'' V_{im}(t') V_{mi}(t'') e^{i\omega_{im}(t'-t'')} \\&
 + -\frac{1}{\hbar^2} \sum_m \int_{t_0}^{t} dt'' \int_{t_0}^{t''} dt' V_{mi}(t'') V_{im}(t') e^{i\omega_{im}(t''-t')}\\
 % &= - \sum_n |{c}_n(t)^{(1)}|^2
\end{aligned}
$$

here in the second line, I have swapped dummy variables $t'$ and $t''$ and used the fact that, noticing that we are integrating over two triangles (variables $t, t''$) of the same equation, they can be combined into a single square integration

$$
\begin{aligned}
 {c}_i(t)^{(2)} +  {c}_i(t)^{(2)*}  
 &= -\frac{1}{\hbar^2} \sum_m \int_{t_0}^{t} dt' \int_{t_0}^{t} dt'' V_{im}(t') V_{mi}(t'') e^{i\omega_{im}(t'-t'')} \\
\end{aligned}
$$

At the same time, we have

$$
\sum_m |c_m^{(1)}|^2 = \frac{1}{\hbar^2} \int_{t_0}^{t}\!\! dt' \int_{t_0}^{t}\!\! dt'' \sum_m
     V_{mi}(t') V_{im}(t'') e^{i\omega_{mi}(t'-t'')} = -\left[ {c}_i(t)^{(2)} +  {c}_i(t)^{(2)*}  \right]
$$ 

This means that the second order expansion of amplitude generates a decrease
in the possibility of finding the system in the original state $i$, and this
decrease in possibility exactly compensates for the added norm from the first
order expansion of the amplitude. However, doing so also introduces additional
higher-order deviation of the norm which will get canceled by even higher-order
amplitude expansion. And in an infinite order expansion, the norm is recovered.


<!-- {% include admonition.html type="note" title="note" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="abstract" title="abstract" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="info" title="Info" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="tip" title="tip" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="success" title="success" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="question" title="question" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="warning" title="warning" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="failure" title="failure" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="danger" title="danger" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="bug" title="bug" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="example" title="example" body="This is information intended to draw attention." %} -->
<!-- {% include admonition.html type="quote" title="quote" body="This is information intended to draw attention." %} -->

