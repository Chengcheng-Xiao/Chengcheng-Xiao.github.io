---
layout: post
title: (De)localization index
date: 2022-10-18
categories: Post
description: Bader basin decomposed integration of exchange density matrix.
tags: DFT
---

<!-- REF1: https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6049528/ -->
<!-- REF2: https://onlinelibrary.wiley.com/doi/10.1002/adma.201806280 -->
<!-- REF3: https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.560230605 -->

I find the method used in [this paper](https://onlinelibrary.wiley.com/doi/10.1002/adma.201806280)
to be quite interesting.
With a bit of research, I can now understand and reproduce some of their results.

First let's rememeber the exchange density matrix (ignoring the renormalization factor):

$$
\begin{aligned}
\rho_x(r_1,r_2) &= |\rho(r_1,r_2)|^2  = |\sum_i \psi_i^*(r_1) \psi_i (r_2) |^2\\
& = \sum_i \psi_i^* (r_1) \psi_i (r_2) \sum_j \psi_j^*(r_1) \psi_j (r_2)\\
& = \sum_{ij} \psi_i^* (r_1) \psi_j^*(r_1) \psi_i (r_2) \psi_j(r_2) 
\end{aligned}
$$

which is the numerator of the [exchange integral](https://en.wikipedia.org/wiki/Exchange_interaction).

Previously, we have demonstrated that the probability of finding electron $1$ at $r_1$ and electron $2$ at $r_2$ is:

$$
P(r_1,r_2) = \rho(r_1)\rho(r_2) -|\rho(r_1,r_2)|^2.
$$

Immediately  know that:

$$
\rho_x(r_1,r_2) = \rho(r_1)\rho(r_2) - P(r_1,r_2) ,
$$

<!-- which corresponeds to REF's description above Eq. 4. -->

---

If we integrate over the entire space for both $r_1$ and $r_2$, we get:

$$
\begin{aligned}
\int_{\R^3} \int_{\R^3} \rho_x(r_1, r_2) dr_1 dr_2 &= \int_{\R^3} \int_{\R^3} \sum^{occ}_{ij} \psi_i^* (r_1) \psi_j^*(r_1) \psi_i (r_2) \psi_j(r_2)  dr_1 dr_2 \\
&= \sum^{occ}_{i=j} \int_{\R^3} \psi_i^* (r_1) \psi_i^*(r_1)  dr_1 \int_{\R^3}  \psi_i (r_2) \psi_i(r_2) dr_2 \\
&+ \sum^{occ}_{i \neq j} \int_{\R^3} \psi_j^* (r_1) \psi_i^*(r_1)  dr_1 \int_{\R^3}  \psi_j (r_2) \psi_i(r_2) dr_2 \\
&= \sum^{occ}_{i=j} \int_{\R^3} \psi_i^* (r_1) \psi_i^*(r_1)  dr_1 \int_{\R^3}  \psi_i (r_2) \psi_i(r_2) dr_2 + 0 \\
&= N ,
\end{aligned}
$$

where we've used the fact that $\psi$ is orthonormalized and summing to $occ$ gives back the number of electron $N$.

---
However, if we break up the integration using the Bader basin (each basin being associated with an atom) of the charge density, we can get two different types of "indcies":

- Delocalization index: measures the number of electron pairs that are being shared between quantum atoms $\Omega_{\mathrm{A}}$ and $\Omega_{\mathrm{B}}$.

$$
\delta(\mathrm{A}, \mathrm{B})=2 \int_{\Omega_{\mathrm{A}}} \int_{\Omega_{\mathrm{B}}} \rho_{\mathrm{x}}\left(\mathbf{r}_1, \mathbf{r}_2\right) \mathrm{d} \mathbf{r}_1 \mathrm{~d} \mathbf{r}_2
$$

- Localization index: measures the electron population of each atom basin  $\Omega_{\mathrm{A}}$.

$$
\lambda(\mathrm{A})=\int_{\Omega_{\mathrm{A}}} \int_{\Omega_{\mathrm{A}}} \rho_{\mathrm{x}}\left(\mathbf{r}_1, \mathbf{r}_2\right) \mathrm{d} \mathbf{r}_1 \mathrm{~d} \mathbf{r}_2
$$

and we can write:

$$
\int_{\R^3} \int_{\R^3} \rho_x(r_1, r_2) dr_1 dr_2 = \sum_A \lambda(\mathrm{A}) + \sum_A \sum_{B \neq A} \delta(\mathrm{A}, \mathrm{B})
$$

---
Code (pseudo wfc based): coming soon.
